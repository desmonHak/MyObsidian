[[convenciones-de-llamadas]]
[https://en.wikipedia.org/wiki/X86_calling_conventions](https://en.wikipedia.org/wiki/X86_calling_conventions)

En [Delphi](https://en.wikipedia.org/wiki/Delphi_(software) "Delphi (software)") y [Free Pascal](https://en.wikipedia.org/wiki/Free_Pascal "Free Pascal") sobre [Microsoft Windows](https://en.wikipedia.org/wiki/Microsoft_Windows), la convención de llamada a llamada segura encapsula el manejo de errores ``COM`` ([Component Object Mode](https://en.wikipedia.org/wiki/Component_Object_Model)), por lo que las excepciones no se filtran a quien llama, sino que se reportan en el valor de retorno [HRESULT](https://en.wikipedia.org/wiki/HRESULT "HRESULT"), tal y como requiere ``COM``/``OLE``. Cuando se llama a una función ``safecall`` desde código ``Delphi``, ``Delphi`` también comprueba automáticamente el ``HRESULT`` devuelto y lanza una excepción si es necesario.

La convención de llamada ``safecall`` es la misma que la convención de llamada [[__stdcall]], excepto que las excepciones se devuelven a la persona que llama en ``EAX`` como un ``HResult`` (en lugar de en ``FS``:[0]), mientras que el resultado de la función se pasa por referencia en la pila como si fuera un parámetro final "out". Cuando se llama a una función ``Delphi`` desde ``Delphi`` esta convención de llamada aparecerá como cualquier otra convención de llamada, porque aunque las excepciones se pasan de vuelta en ``EAX``, son automáticamente convertidas de vuelta a excepciones apropiadas por el llamador. Cuando se utilizan objetos ``COM`` creados en otros lenguajes, los ``HResults`` se lanzarán automáticamente como excepciones, y el resultado para las funciones Get está en el resultado en lugar de ser un parámetro. Cuando se crean objetos COM en Delphi con ``safecall``, no hay necesidad de preocuparse por los ``HResults``, ya que las excepciones pueden ser lanzadas como normales pero serán vistas como ``HResults`` en otros lenguajes.
